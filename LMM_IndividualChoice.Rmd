---
title: "LMM_NF"
output: html_document
date: "2024-02-04"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load libraries
```{r}
library(knitr)
library(rmdformats)
library(ggplot2)
library(ggpubr)
library(GGally)
```


```{r, warning = FALSE, message = FALSE}
library(tidyverse)
library(lme4)
library(lmerTest)
library("MuMIn")
library(lmtest)
library(boot)
```

Read dataset
```{r}
AllSubs_NeuralActivation <- read.csv('/Users/luisalvarez/Documents/GitHub/RM_Thesis_Neuroforecasting/ProcessedData/AllSubs_NeuralActivation.csv')
```

# M1: Behavioral data
```{r, echo = FALSE}
M1 <- lmer(W_score~ (Type) + scale(Pos_arousal) + scale(Neg_arousal) + (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M1)
r.squaredGLMM(M1)
```
# M1 Pairs plot 
```{r}
W_score <- AllSubs_NeuralActivation %>% pull(W_score)
A_score <- AllSubs_NeuralActivation %>% pull(A_score)
F_score <- AllSubs_NeuralActivation %>% pull(F_score)

M1_data <- data.frame(W_score, A_score, F_score) 

#ggpairs(M1_data)
```
# M2: Neural activation (whole)
```{r, echo = FALSE}
M2 <- lmer(W_score~ (Type) + scale(NAcc_whole) + scale(AIns_whole) + scale(MPFC_whole) +
             + scale(NAcc_whole):Type + scale(AIns_whole):Type + scale(MPFC_whole):Type + (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M2)
r.squaredGLMM(M2)
```
# M3: Neural activation (whole) + Behavioral data
```{r, echo = FALSE}
M3 <- lmer(W_score~ (Type) + scale(Pos_arousal) + scale(Neg_arousal) +  
             scale(NAcc_whole) + scale(AIns_whole) + scale(MPFC_whole) + 
             scale(NAcc_whole):Type + scale(AIns_whole):Type + scale(MPFC_whole):Type + 
             (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M3)
r.squaredGLMM(M3)
```
# Compare brhavioral and neural models
```{r}
AIC(M1, M2, M3)
```
# M3 Pairs plot 
```{r}
NAcc_whole <- AllSubs_NeuralActivation %>% pull(NAcc_whole)
AIns_whole <- AllSubs_NeuralActivation %>% pull(AIns_whole)
MPFC_whole <- AllSubs_NeuralActivation %>% pull(MPFC_whole)

M3_data <- data.frame(W_score, A_score, F_score, NAcc_whole, AIns_whole, MPFC_whole) 

ggpairs(M3_data)
```

# M4: Neural ISC 
```{r, echo = FALSE}
M4 <- lmer(W_score~ (Type) + scale(NAcc_ISC) + scale(AIns_ISC) + scale(MPFC_ISC) +
             + scale(NAcc_ISC):Type + scale(AIns_ISC):Type + scale(MPFC_ISC):Type +
             (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M4)
r.squaredGLMM(M4)
```

# M5: Neural ISC + Behavioral data
```{r, echo = FALSE}
M5 <- lmer(W_score~ (Type) + scale(Pos_arousal) + scale(Neg_arousal) + 
             scale(NAcc_ISC) + scale(AIns_ISC) + scale(MPFC_ISC) +
             + scale(NAcc_ISC):Type + scale(AIns_ISC):Type + scale(MPFC_ISC):Type +
             (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M5)
r.squaredGLMM(M5)
```
# Compare just behavioral data vs. (neural activation whole + behavioral data)
# vs. (neural ISC + behavioral data)
```{r}
AIC(M1, M3, M5)
```
# M6: Neural activation (middle)
```{r, echo = FALSE}
M6 <- lmer(W_score~ (Type) + scale(NAcc_middle) + scale(AIns_middle) + scale(MPFC_middle) +
             + scale(NAcc_middle):Type + scale(AIns_middle):Type + scale(MPFC_middle):Type + (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M6)
r.squaredGLMM(M6)
```
# M7: Neural activation (middle) + behavioral data
```{r, echo = FALSE}
M7 <- lmer(W_score~ (Type) + scale(Pos_arousal) + scale(Neg_arousal) +  
             scale(NAcc_middle) + scale(AIns_middle) + scale(MPFC_middle) +
             + scale(NAcc_middle):Type + scale(AIns_middle):Type + scale(MPFC_middle):Type +
             (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M7)
r.squaredGLMM(M7)
```
# M8: Neural ISC + Neural activation (middle) + behavioral data
```{r, echo = FALSE}
M8 <- lmer(W_score~ (Type) + scale(Pos_arousal) + scale(Neg_arousal) +  
             scale(NAcc_middle) + scale(AIns_middle) + scale(MPFC_middle) +
             + scale(NAcc_middle):Type + scale(AIns_middle):Type + scale(MPFC_middle):Type +
             (1|Participant) + (1|Trailer), data = AllSubs_NeuralActivation)
summary(M8)
r.squaredGLMM(M8)
```












